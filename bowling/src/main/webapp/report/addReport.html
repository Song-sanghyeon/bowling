<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Add report</title>
<style>
	#board {
		width:700px;
		text-align:center;
		height:150px;
	}
	#nameframe {
		width:100px;
	}
</style>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script src="/scripts/addReport.js"></script>
</head>
<body>
	<h1>Insert Form</h1>
	<div id="getGame">
		<h2>GetTeam</h2>
		<div>
			<span id="getStadium"></span>
		</div>
		<!-- hometeam 선택 -->
		<select id = "getHomeTeam">
			<option>팀 선택</option>
		</select>
		
		<!-- hometeam 선수 선택 -->
		<select id = "getHomeTeamPlayer">
			<option value=0>선수 선택</option>
		</select>
		
		<!-- awayteam 선택 -->
		<select id = "getAwayTeam">
			<option>팀 선택</option>
		</select>
		
		<!-- awayteam 선수 선택 -->
		<select id = "getAwayTeamPlayer">
			<option value=0>선수 선택</option>
		</select>
	</div>
	
	<button id="gameStartBtn">게임시작</button>
	
	<div id="addPin">
		<h2>Insert Pin</h2>
		<!-- 전광판 -->
		<div>게임ID: <p id="gameNumber"></p></div>
		<div>
			<table border = "1" id="board">
				<tr>
					<td id="nameframe">이름/프레임</td>
					<td>1</td>
					<td>2</td>
					<td>3</td>
					<td>4</td>
					<td>5</td>
					<td>6</td>
					<td>7</td>
					<td>8</td>
					<td>9</td>
					<td>10</td>
					<td>총 점수</td>
				</tr>
				<tr>
					<td id="homeTeamPlayer"></td>
					<td id="h1"></td>
					<td id="h2"></td>
					<td id="h3"></td>
					<td id="h4"></td>
					<td id="h5"></td>
					<td id="h6"></td>
					<td id="h7"></td>
					<td id="h8"></td>
					<td id="h9"></td>
					<td id="h10"></td>
					<td></td>
				</tr>
				<tr>
					<td id="awayTeamPlayer"></td>
					<td id="a1"></td>
					<td id="a2"></td>
					<td id="a3"></td>
					<td id="a4"></td>
					<td id="a5"></td>
					<td id="a6"></td>
					<td id="a7"></td>
					<td id="a8"></td>
					<td id="a9"></td>
					<td id="a10"></td>
					<td></td>
				</tr>
			</table>
		</div>
		<br>
		<table border="1">
		<!-- addReport폼 생성, Check 박스 생성 -->
			<tr>
				<td>1<input class="pinCheck" type="checkbox" id="pin1"></td>
				<td>2<input class="pinCheck" type="checkbox" id="pin2"></td>
				<td>3<input class="pinCheck" type="checkbox" id="pin3"></td>
				<td>4<input class="pinCheck" type="checkbox" id="pin4"></td>
				<td>5<input class="pinCheck" type="checkbox" id="pin5"></td>
				<td>6<input class="pinCheck" type="checkbox" id="pin6"></td>
				<td>7<input class="pinCheck" type="checkbox" id="pin7"></td>
				<td>8<input class="pinCheck" type="checkbox" id="pin8"></td>
				<td>9<input class="pinCheck" type="checkbox" id="pin9"></td>
				<td>10<input class="pinCheck" type="checkbox" id="pin10"></td>
			</tr>
		</table>
		<br>
		<button type="button" id="addPinBtn">쓰러진 핀 입력</button>
		<div>
			<button type="button" id="strikeBtn">스트라이크</button>
			<button type="button" id="resetBtn">초기화</button>
		</div>
	</div>
</body>
<script>
	$(document).ready(function(){
		// 변수
		let game = {
			// pin : 볼링 핀의 배열 초기값은 0으로 설정 
			pin : [0,0,0,0,0,0,0,0,0,0],
			// turn1PinSum : 처음 쓰러트린 핀의 갯수
			pinSum : 0,
			// turn : 해당선수의 회차
			turn : 1,
			// frame : 해당선수의 프레임
			frame : 1,
			// player : 선수의 차례를 구분하기위한 변수
			// player의 값이 1 : awayTeamPlayer
			// player의 값이 2 : homeTeamPlayer
			player : 1,
			// game_no 해당 경기의 인덱스값
			gameNo : 0
		};
		
		// 팀을 선택하기전에 핀을 숨겨 놓는다
		$("#addPin").hide();
		$("#homeTeamPlayerSelect").empty();

		//게임시작 버튼 클릭시 경기의 데이터를 기록할 수 있다
		$("#gameStartBtn").on("click",function(){
			if($("#getHomeTeamPlayer").val()!=0	&& $("#getAwayTeamPlayer").val()!=0){
				$("#gameStartBtn").hide();
				$("#getGame").hide();
				$("#addPin").show();
				
				// ### 경기 기록 ######################################################################################################################
				$.ajax({
					url:"/addGame",
					method:"POST",
					data:{"hteamName":$("#getHomeTeam").val(),
						  "stadiumName":$("#getStadium").text(),
						  "ateamName":$("#getAwayTeam").val()
						 },
					success:function(json){
						console.log("경기 시작 !");
						game.gameNo = json.gameNo;
						// console.log("gameNo : ", gameNo);
					}
				});
				
				// ### 홈 팀 구장 가져오기 ######################################################################################################################
			}else{
				alert("팀과 선수를 입력해주세요!");
			}
		});

		// game 테이블에  경기 데이터를 입력하기 위해 데이터 출력하는 함수 실행
		setGame();
		
		$("#strikeBtn").on("click",function(){
			$(".pinCheck").prop("checked", true);
		});
		
		$("#resetBtn").on("click",function(){
			$(".pinCheck").prop("checked", false);
		});
		
// ### 핀 입력 ############################################################################################################
		$("#addPinBtn").on("click",function(){
			// console.log("버튼클릭");
			
			// 체크한 핀을 pin 배열의 값 저장하는 함수 실행
			game.pin = setPinArray(game.pin);
			console.log("pin : ", game.pin);
			
			// 선수의 데이터를 기록하는 함수
			game = addReport(game);
			/*
			console.log("frame : ", game.frame);
			console.log("turn : ", game.turn);
			console.log("player : ", game.player);
			console.log("pinSum : ", game.pinSum);
			*/
		});
// ### 핀 입력 ############################################################################################################	
	
	});
</script>
</html>